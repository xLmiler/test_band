<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Business è´¦å·ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        :root {
            --primary-color: #5B9BD5;
            --primary-light: rgba(91, 155, 213, 0.1);
            --primary-dark: #4A8BC4;
            --bg-color: #F0F4F8;
            --card-bg: rgba(255, 255, 255, 0.85);
            --text-color: #333;
            --text-muted: #666;
            --success-color: #4CAF50;
            --warning-color: #FF9800;
            --error-color: #F44336;
            --border-radius: 12px;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, var(--bg-color) 0%, #E8EEF5 100%);
            min-height: 100vh;
            color: var(--text-color);
        }

        /* ç™»å½•é¡µé¢ */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            padding: 40px;
            width: 100%;
            max-width: 400px;
            box-shadow: var(--shadow);
        }

        .login-card h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 30px;
            font-size: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-muted);
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* å¯†ç è¾“å…¥æ¡†å®¹å™¨ */
        .password-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .password-wrapper input {
            padding-right: 45px;
        }

        .password-toggle {
            position: absolute;
            right: 12px;
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            font-size: 18px;
            color: var(--text-muted);
            transition: color 0.3s;
        }

        .password-toggle:hover {
            color: var(--primary-color);
        }

        .password-toggle .eye-open {
            display: none;
        }

        .password-toggle .eye-closed {
            display: inline;
        }

        .password-toggle.visible .eye-open {
            display: inline;
        }

        .password-toggle.visible .eye-closed {
            display: none;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(91, 155, 213, 0.4);
        }

        .btn-secondary {
            background: #E0E0E0;
            color: var(--text-color);
        }

        .btn-secondary:hover {
            background: #D0D0D0;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #43A047;
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
        }

        .btn-warning:hover {
            background: #F57C00;
        }

        .btn-danger {
            background: var(--error-color);
            color: white;
        }

        .btn-danger:hover {
            background: #D32F2F;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 13px;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* ä¸»å¸ƒå±€ */
        .app-container {
            display: none;
            min-height: 100vh;
        }

        .header {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            color: var(--primary-color);
            font-size: 20px;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .color-picker-wrapper {
            position: relative;
        }

        .color-picker-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 2px solid #E0E0E0;
            cursor: pointer;
            background: var(--primary-color);
            transition: transform 0.3s;
        }

        .color-picker-btn:hover {
            transform: scale(1.1);
        }

        .color-picker-input {
            position: absolute;
            opacity: 0;
            width: 36px;
            height: 36px;
            cursor: pointer;
        }

        .main-content {
            padding: 24px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ç»Ÿè®¡å¡ç‰‡ */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            padding: 24px;
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }

        .stat-card .stat-value {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .stat-card .stat-label {
            color: var(--text-muted);
            font-size: 14px;
        }

        .stat-card.total .stat-value {
            color: var(--primary-color);
        }

        .stat-card.success .stat-value {
            color: var(--success-color);
        }

        .stat-card.creating .stat-value {
            color: var(--warning-color);
        }

        .stat-card.failed .stat-value {
            color: var(--error-color);
        }

        /* æ ‡ç­¾é¡µ */
        .tabs-container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .tabs-header {
            display: flex;
            border-bottom: 1px solid #E0E0E0;
        }

        .tab-btn {
            flex: 1;
            padding: 16px 24px;
            background: none;
            border: none;
            font-size: 15px;
            font-weight: 500;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .tab-btn:hover {
            color: var(--primary-color);
            background: var(--primary-light);
        }

        .tab-btn.active {
            color: var(--primary-color);
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-color);
        }

        .tabs-content {
            padding: 24px;
        }

        .tab-panel {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-panel.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* å·¥å…·æ  */
        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 20px;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 10px 16px 10px 40px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .search-box::before {
            content: 'ğŸ”';
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
        }

        .filter-select {
            padding: 10px 16px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        /* è¡¨æ ¼ */
        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th,
        td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid #E0E0E0;
        }

        th {
            background: #F5F7FA;
            font-weight: 600;
            color: var(--text-muted);
            font-size: 13px;
            text-transform: uppercase;
        }

        tr:hover {
            background: var(--primary-light);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-success {
            background: rgba(76, 175, 80, 0.1);
            color: var(--success-color);
        }

        .status-creating {
            background: rgba(255, 152, 0, 0.1);
            color: var(--warning-color);
        }

        .status-failed {
            background: rgba(244, 67, 54, 0.1);
            color: var(--error-color);
        }

        .status-updating {
            background: rgba(91, 155, 213, 0.1);
            color: var(--primary-color);
        }

        .actions-cell {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        /* åˆ†é¡µ */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 20px;
        }

        .pagination button {
            padding: 8px 16px;
            border: 1px solid #E0E0E0;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pagination button:hover:not(:disabled) {
            background: var(--primary-light);
            border-color: var(--primary-color);
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination .page-info {
            color: var(--text-muted);
            font-size: 14px;
        }

        /* è®¾ç½®é¢æ¿ */
        .settings-section {
            margin-bottom: 32px;
        }

        .settings-section h3 {
            margin-bottom: 16px;
            color: var(--primary-color);
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 16px;
        }

        .setting-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .setting-item label {
            font-size: 14px;
            color: var(--text-muted);
        }

        .setting-item input,
        .setting-item select {
            padding: 10px 14px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 14px;
        }

        .setting-item input:focus,
        .setting-item select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* é‚®ç®±é…ç½®åˆ—è¡¨ */
        .email-config-list {
            background: #F5F7FA;
            border-radius: 8px;
            padding: 16px;
        }

        .email-config-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .email-config-item:last-child {
            margin-bottom: 0;
        }

        .email-config-item .domain {
            flex: 1;
            font-weight: 500;
        }

        /* æ¨¡æ€æ¡† */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: var(--border-radius);
            padding: 24px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-hover);
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            font-size: 18px;
            color: var(--primary-color);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-muted);
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* è¯¦æƒ…è§†å›¾ */
        .detail-section {
            margin-bottom: 20px;
        }

        .detail-section h4 {
            color: var(--primary-color);
            margin-bottom: 12px;
            font-size: 14px;
            border-bottom: 1px solid #E0E0E0;
            padding-bottom: 8px;
        }

        .detail-item {
            display: flex;
            margin-bottom: 12px;
        }

        .detail-label {
            width: 140px;
            color: var(--text-muted);
            font-size: 14px;
            flex-shrink: 0;
        }

        .detail-value {
            flex: 1;
            word-break: break-all;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            background: #F5F7FA;
            padding: 8px 12px;
            border-radius: 6px;
            max-height: 100px;
            overflow-y: auto;
        }

        .detail-value.empty {
            color: var(--text-muted);
            font-style: italic;
        }

        .detail-value.copyable {
            cursor: pointer;
            position: relative;
        }

        .detail-value.copyable:hover {
            background: #E8EEF5;
        }

        .detail-value.copyable::after {
            content: 'ğŸ“‹';
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
            transition: opacity 0.2s;
        }

        .detail-value.copyable:hover::after {
            opacity: 1;
        }

        /* Toast é€šçŸ¥ */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2000;
        }

        .toast {
            background: white;
            border-radius: 8px;
            padding: 16px 20px;
            margin-bottom: 10px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 12px;
            animation: toastIn 0.3s ease;
            max-width: 350px;
        }

        .toast.success {
            border-left: 4px solid var(--success-color);
        }

        .toast.error {
            border-left: 4px solid var(--error-color);
        }

        .toast.warning {
            border-left: 4px solid var(--warning-color);
        }

        @keyframes toastIn {
            from {
                opacity: 0;
                transform: translateX(100%);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #E0E0E0;
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* ç©ºçŠ¶æ€ */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }

        .empty-state .icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }

            .toolbar {
                flex-direction: column;
            }

            .search-box {
                width: 100%;
            }

            .header h1 {
                font-size: 16px;
            }

            .tabs-header {
                flex-direction: column;
            }

            .tab-btn {
                text-align: center;
            }

            .actions-cell {
                flex-direction: column;
            }

            .detail-item {
                flex-direction: column;
            }

            .detail-label {
                width: 100%;
                margin-bottom: 4px;
            }
        }
    </style>
</head>

<body>
    <!-- ç™»å½•é¡µé¢ -->
    <div class="login-container" id="loginPage">
        <div class="login-card">
            <h1>ğŸ” ç®¡ç†å‘˜ç™»å½•</h1>
            <form id="loginForm">
                <div class="form-group">
                    <label>ç”¨æˆ·å</label>
                    <input type="text" id="username" required placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
                </div>
                <div class="form-group">
                    <label>å¯†ç </label>
                    <div class="password-wrapper">
                        <input type="password" id="password" required placeholder="è¯·è¾“å…¥å¯†ç ">
                        <button type="button" class="password-toggle" onclick="togglePassword('password', this)">
                            <span class="eye-open">ğŸ‘ï¸</span>
                            <span class="eye-closed">ğŸ‘ï¸â€ğŸ—¨ï¸</span>
                        </button>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">ç™»å½•</button>
            </form>
        </div>
    </div>

    <!-- ä¸»åº”ç”¨ -->
    <div class="app-container" id="appContainer">
        <!-- å¤´éƒ¨ -->
        <header class="header">
            <h1>ğŸ“Š Gemini Business è´¦å·ç®¡ç†ç³»ç»Ÿ</h1>
            <div class="header-actions">
                <div class="color-picker-wrapper">
                    <input type="color" class="color-picker-input" id="colorPicker" value="#5B9BD5">
                    <div class="color-picker-btn" id="colorPickerBtn" title="è‡ªå®šä¹‰ä¸»é¢˜è‰²"></div>
                </div>
                <button class="btn btn-secondary btn-small" onclick="logout()">é€€å‡º</button>
            </div>
        </header>

        <!-- ä¸»å†…å®¹ -->
        <main class="main-content">
            <!-- ç»Ÿè®¡å¡ç‰‡ -->
            <div class="stats-container">
                <div class="stat-card total">
                    <div class="stat-value" id="statTotal">0</div>
                    <div class="stat-label">æ€»è´¦å·æ•°</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-value" id="statSuccess">0</div>
                    <div class="stat-label">æ³¨å†ŒæˆåŠŸ</div>
                </div>
                <div class="stat-card creating">
                    <div class="stat-value" id="statCreating">0</div>
                    <div class="stat-label">æ­£åœ¨åˆ›å»º</div>
                </div>
                <div class="stat-card failed">
                    <div class="stat-value" id="statFailed">0</div>
                    <div class="stat-label">åˆ›å»ºå¤±è´¥</div>
                </div>
            </div>

            <!-- æ ‡ç­¾é¡µ -->
            <div class="tabs-container">
                <div class="tabs-header">
                    <button class="tab-btn active" data-tab="accounts">ğŸ“‹ è´¦å·ç®¡ç†</button>
                    <button class="tab-btn" data-tab="settings">âš™ï¸ ç³»ç»Ÿè®¾ç½®</button>
                </div>

                <div class="tabs-content">
                    <!-- è´¦å·ç®¡ç† -->
                    <div class="tab-panel active" id="accountsPanel">
                        <div class="toolbar">
                            <div class="search-box">
                                <input type="text" id="searchInput" placeholder="æœç´¢é‚®ç®±...">
                            </div>
                            <select class="filter-select" id="statusFilter">
                                <option value="">å…¨éƒ¨çŠ¶æ€</option>
                                <option value="success">æˆåŠŸ</option>
                                <option value="creating">åˆ›å»ºä¸­</option>
                                <option value="updating">æ›´æ–°ä¸­</option>
                                <option value="failed">å¤±è´¥</option>
                            </select>
                            <button class="btn btn-primary btn-small" onclick="createAccount()">
                                â• åˆ›å»ºè´¦å·
                            </button>
                            <button class="btn btn-warning btn-small" onclick="refreshAllAccounts()">
                                ğŸ”„ æ›´æ–°å…¨éƒ¨
                            </button>
                            <button class="btn btn-danger btn-small" onclick="stopAll()">
                                â¹ åœæ­¢å…¨éƒ¨
                            </button>
                            <button class="btn btn-success btn-small" onclick="exportAccounts()">
                                ğŸ“¥ å¯¼å‡ºæ•°æ®
                            </button>
                        </div>

                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>é‚®ç®±</th>
                                        <th>çŠ¶æ€</th>
                                        <th>åˆ›å»ºæ—¶é—´</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="accountsTable">
                                    <tr>
                                        <td colspan="4">
                                            <div class="empty-state">
                                                <div class="icon">ğŸ“­</div>
                                                <p>æš‚æ— è´¦å·æ•°æ®</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="pagination" id="pagination">
                            <button id="prevPage" disabled>ä¸Šä¸€é¡µ</button>
                            <span class="page-info" id="pageInfo">ç¬¬ 1 é¡µ / å…± 1 é¡µ</span>
                            <button id="nextPage" disabled>ä¸‹ä¸€é¡µ</button>
                        </div>
                    </div>

                    <!-- ç³»ç»Ÿè®¾ç½® -->
                    <div class="tab-panel" id="settingsPanel">
                        <!-- æµè§ˆå™¨è®¾ç½® -->
                        <div class="settings-section">
                            <h3>ğŸŒ æµè§ˆå™¨è®¾ç½®</h3>
                            <div class="settings-grid">
                                <div class="setting-item">
                                    <label>User-Agent</label>
                                    <input type="text" id="settingUA">
                                </div>
                                <div class="setting-item">
                                    <label>æœ€å¤§å¹¶å‘æ•°</label>
                                    <input type="number" id="settingMaxWorkers" min="1" max="10">
                                </div>
                                <div class="setting-item">
                                    <label>æ— å¤´æ¨¡å¼</label>
                                    <select id="settingHeadless">
                                        <option value="true">å¼€å¯</option>
                                        <option value="false">å…³é—­</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- æŒ‡çº¹è®¾ç½® -->
                        <div class="settings-section">
                            <h3>ğŸ­ æµè§ˆå™¨æŒ‡çº¹</h3>
                            <div class="settings-grid">
                                <div class="setting-item">
                                    <label>çª—å£å¤§å°</label>
                                    <input type="text" id="settingWindowSize" placeholder="1920x1080">
                                </div>
                                <div class="setting-item">
                                    <label>æ—¶åŒº</label>
                                    <input type="text" id="settingTimezone" placeholder="Asia/Shanghai">
                                </div>
                                <div class="setting-item">
                                    <label>è¯­è¨€</label>
                                    <input type="text" id="settingLocale" placeholder="zh-CN">
                                </div>
                            </div>
                        </div>

                        <!-- é‚®ç®±é…ç½® -->
                        <div class="settings-section">
                            <h3>ğŸ“§ é‚®ç®±åŸŸé…ç½®</h3>
                            <div class="email-config-list" id="emailConfigList">
                                <div class="empty-state">
                                    <p>æš‚æ— é…ç½®</p>
                                </div>
                            </div>
                            <button class="btn btn-primary btn-small" style="margin-top: 12px;"
                                onclick="showAddEmailConfig()">
                                â• æ·»åŠ é…ç½®
                            </button>
                        </div>

                        <button class="btn btn-primary" onclick="saveSettings()">
                            ğŸ’¾ ä¿å­˜è®¾ç½®
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- æ¨¡æ€æ¡†ï¼šè´¦å·è¯¦æƒ… -->
    <div class="modal-overlay" id="detailModal">
        <div class="modal">
            <div class="modal-header">
                <h2>ğŸ“„ è´¦å·è¯¦æƒ…</h2>
                <button class="modal-close" onclick="closeModal('detailModal')">&times;</button>
            </div>
            <div class="modal-body" id="detailContent">
                <!-- åŠ¨æ€å¡«å…… -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('detailModal')">å…³é—­</button>
            </div>
        </div>
    </div>

    <!-- æ¨¡æ€æ¡†ï¼šæ·»åŠ é‚®ç®±é…ç½® -->
    <div class="modal-overlay" id="emailConfigModal">
        <div class="modal">
            <div class="modal-header">
                <h2>ğŸ“§ æ·»åŠ é‚®ç®±é…ç½®</h2>
                <button class="modal-close" onclick="closeModal('emailConfigModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Worker Domain</label>
                    <input type="text" id="newWorkerDomain" placeholder="apimail.example.com">
                </div>
                <div class="form-group">
                    <label>Email Domain</label>
                    <input type="text" id="newEmailDomain" placeholder="example.com">
                </div>
                <div class="form-group">
                    <label>Admin Password</label>
                    <div class="password-wrapper">
                        <input type="password" id="newAdminPassword" placeholder="ç®¡ç†å‘˜å¯†ç ">
                        <button type="button" class="password-toggle"
                            onclick="togglePassword('newAdminPassword', this)">
                            <span class="eye-open">ğŸ‘ï¸</span>
                            <span class="eye-closed">ğŸ‘ï¸â€ğŸ—¨ï¸</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('emailConfigModal')">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="addEmailConfig()">æ·»åŠ </button>
            </div>
        </div>
    </div>

    <!-- æ¨¡æ€æ¡†ï¼šåˆ›å»ºè´¦å· -->
    <div class="modal-overlay" id="createModal">
        <div class="modal">
            <div class="modal-header">
                <h2>â• åˆ›å»ºæ–°è´¦å·</h2>
                <button class="modal-close" onclick="closeModal('createModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>é‚®ç®±ç”¨æˆ·å (å¯é€‰ï¼Œç•™ç©ºè‡ªåŠ¨ç”Ÿæˆ)</label>
                    <input type="text" id="newUsername" placeholder="ç•™ç©ºè‡ªåŠ¨ç”Ÿæˆéšæœºç”¨æˆ·åå­—">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('createModal')">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="submitCreateAccount()">åˆ›å»º</button>
            </div>
        </div>
    </div>

    <!-- Toast å®¹å™¨ -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        // å…¨å±€çŠ¶æ€
        let authToken = localStorage.getItem('authToken') || '';
        let currentPage = 1;
        let totalPages = 1;
        let refreshInterval = null;

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            if (authToken) {
                showApp();
            }

            initEventListeners();
        });

        // åˆ‡æ¢å¯†ç æ˜¾ç¤º
        function togglePassword(inputId, button) {
            const input = document.getElementById(inputId);
            const isPassword = input.type === 'password';
            input.type = isPassword ? 'text' : 'password';
            button.classList.toggle('visible', isPassword);
        }

        // äº‹ä»¶ç›‘å¬
        function initEventListeners() {
            // ç™»å½•è¡¨å•
            document.getElementById('loginForm').addEventListener('submit', handleLogin);

            // æ ‡ç­¾é¡µåˆ‡æ¢
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => switchTab(btn.dataset.tab));
            });

            // æœç´¢å’Œç­›é€‰
            document.getElementById('searchInput').addEventListener('input', debounce(loadAccounts, 300));
            document.getElementById('statusFilter').addEventListener('change', loadAccounts);

            // åˆ†é¡µ
            document.getElementById('prevPage').addEventListener('click', () => changePage(-1));
            document.getElementById('nextPage').addEventListener('click', () => changePage(1));

            // é¢œè‰²é€‰æ‹©å™¨
            document.getElementById('colorPicker').addEventListener('input', (e) => {
                updateThemeColor(e.target.value);
            });

            document.getElementById('colorPickerBtn').addEventListener('click', () => {
                document.getElementById('colorPicker').click();
            });
        }

        // ç™»å½•å¤„ç†
        async function handleLogin(e) {
            e.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();

                if (data.success) {
                    authToken = data.token;
                    localStorage.setItem('authToken', authToken);
                    showApp();
                    showToast('ç™»å½•æˆåŠŸ', 'success');
                } else {
                    showToast(data.message || 'ç™»å½•å¤±è´¥', 'error');
                }
            } catch (error) {
                showToast('ç½‘ç»œé”™è¯¯', 'error');
            }
        }

        // æ˜¾ç¤ºåº”ç”¨
        function showApp() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';
            loadAccounts();
            loadSettings();
            startAutoRefresh();
        }

        // é€€å‡ºç™»å½•
        function logout() {
            authToken = '';
            localStorage.removeItem('authToken');
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('appContainer').style.display = 'none';
            stopAutoRefresh();
        }

        // API è¯·æ±‚å°è£…
        async function apiRequest(url, options = {}) {
            const headers = {
                'Content-Type': 'application/json',
                ...options.headers
            };

            // Basic Auth
            const credentials = btoa('admin:admin123');
            headers['Authorization'] = `Basic ${credentials}`;

            const response = await fetch(url, { ...options, headers });
            return response;
        }

        // åŠ è½½è´¦å·åˆ—è¡¨
        async function loadAccounts() {
            try {
                const search = document.getElementById('searchInput').value;
                const status = document.getElementById('statusFilter').value;

                const params = new URLSearchParams({
                    page: currentPage,
                    per_page: 20,
                    search,
                    status
                });

                const response = await apiRequest(`/api/accounts?${params}`);
                const data = await response.json();

                if (data.success) {
                    renderAccounts(data.accounts);
                    updateStats(data.stats);
                    updatePagination(data.page, data.total_pages);
                }
            } catch (error) {
                console.error('åŠ è½½è´¦å·å¤±è´¥:', error);
            }
        }

        // æ¸²æŸ“è´¦å·è¡¨æ ¼
        function renderAccounts(accounts) {
            const tbody = document.getElementById('accountsTable');

            if (!accounts || accounts.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4">
                            <div class="empty-state">
                                <div class="icon">ğŸ“­</div>
                                <p>æš‚æ— è´¦å·æ•°æ®</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = accounts.map(acc => `
                <tr>
                    <td>${acc.email || '-'}</td>
                    <td>
                        <span class="status-badge status-${getStatusClass(acc.status)}">
                            ${getStatusText(acc.status)}
                        </span>
                    </td>
                    <td>${formatDate(acc.created_at)}</td>
                    <td class="actions-cell">
                        <button class="btn btn-secondary btn-small" onclick="viewDetail('${acc.email}')">
                            ğŸ‘ï¸ æŸ¥çœ‹
                        </button>
                        ${acc.status === 'success' ? `
                            <button class="btn btn-primary btn-small" onclick="refreshAccount('${acc.email}')">
                                ğŸ”„ åˆ·æ–°
                            </button>
                        ` : ''}
                        ${acc.status === 'failed' ? `
                            <button class="btn btn-warning btn-small" onclick="retryAccount('${acc.email}')">
                                ğŸ” é‡è¯•
                            </button>
                        ` : ''}
                        ${isProcessing(acc.status) ? `
                            <button class="btn btn-danger btn-small" onclick="stopAccount('${acc.email}')">
                                â¹ åœæ­¢
                            </button>
                        ` : ''}
                        <button class="btn btn-danger btn-small" onclick="deleteAccount('${acc.email}')">
                            ğŸ—‘ï¸ åˆ é™¤
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // æ£€æŸ¥æ˜¯å¦æ­£åœ¨å¤„ç†ä¸­
        function isProcessing(status) {
            return ['pending', 'creating_email', 'opening_page', 'entering_email',
                'waiting_code', 'entering_code', 'verifying', 'entering_name',
                'agreeing', 'waiting_redirect', 'completing', 'extracting_data',
                'updating'].includes(status);
        }

        // è·å–çŠ¶æ€æ ·å¼ç±»
        function getStatusClass(status) {
            if (status === 'success') return 'success';
            if (status === 'failed') return 'failed';
            if (status === 'updating') return 'updating';
            return 'creating';
        }

        // è·å–çŠ¶æ€æ–‡æœ¬
        function getStatusText(status) {
            const statusMap = {
                'pending': 'å¾…å¤„ç†',
                'creating_email': 'åˆ›å»ºé‚®ç®±',
                'opening_page': 'æ‰“å¼€é¡µé¢',
                'entering_email': 'è¾“å…¥é‚®ç®±',
                'waiting_code': 'ç­‰å¾…éªŒè¯ç ',
                'entering_code': 'è¾“å…¥éªŒè¯ç ',
                'verifying': 'éªŒè¯ä¸­',
                'entering_name': 'è¾“å…¥å§“å',
                'agreeing': 'åŒæ„æ¡æ¬¾',
                'waiting_redirect': 'ç­‰å¾…è·³è½¬',
                'completing': 'å®Œæˆè®¾ç½®',
                'extracting_data': 'æå–æ•°æ®',
                'success': 'æˆåŠŸ',
                'failed': 'å¤±è´¥',
                'updating': 'æ›´æ–°ä¸­'
            };
            return statusMap[status] || status;
        }

        // æ›´æ–°ç»Ÿè®¡
        function updateStats(stats) {
            if (!stats) return;
            document.getElementById('statTotal').textContent = stats.total || 0;
            document.getElementById('statSuccess').textContent = stats.success || 0;
            document.getElementById('statCreating').textContent = (stats.creating || 0) + (stats.updating || 0);
            document.getElementById('statFailed').textContent = stats.failed || 0;
        }

        // æ›´æ–°åˆ†é¡µ
        function updatePagination(page, total) {
            currentPage = page || 1;
            totalPages = total || 1;

            document.getElementById('pageInfo').textContent = `ç¬¬ ${currentPage} é¡µ / å…± ${totalPages} é¡µ`;
            document.getElementById('prevPage').disabled = currentPage <= 1;
            document.getElementById('nextPage').disabled = currentPage >= totalPages;
        }

        // åˆ‡æ¢é¡µé¢
        function changePage(delta) {
            const newPage = currentPage + delta;
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                loadAccounts();
            }
        }

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabId) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tab === tabId);
            });

            document.querySelectorAll('.tab-panel').forEach(panel => {
                panel.classList.toggle('active', panel.id === tabId + 'Panel');
            });
        }

        // åˆ›å»ºè´¦å·
        function createAccount() {
            openModal('createModal');
        }

        async function submitCreateAccount() {
            const username = document.getElementById('newUsername').value.trim();

            try {
                const response = await apiRequest('/api/accounts', {
                    method: 'POST',
                    body: JSON.stringify({ username })
                });

                const data = await response.json();

                if (data.success) {
                    showToast(`è´¦å·åˆ›å»ºå·²å¼€å§‹: ${data.email}`, 'success');
                    closeModal('createModal');
                    document.getElementById('newUsername').value = '';
                    loadAccounts();
                } else {
                    showToast(data.error || 'åˆ›å»ºå¤±è´¥', 'error');
                }
            } catch (error) {
                showToast('ç½‘ç»œé”™è¯¯', 'error');
            }
        }

        // æŸ¥çœ‹è¯¦æƒ…
        async function viewDetail(email) {
            try {
                const response = await apiRequest(`/api/accounts?email=${encodeURIComponent(email)}`);
                const data = await response.json();

                if (data.success && data.account) {
                    const acc = data.account;
                    document.getElementById('detailContent').innerHTML = `
                        <div class="detail-section">
                            <h4>ğŸ“§ åŸºæœ¬ä¿¡æ¯</h4>
                            <div class="detail-item">
                                <span class="detail-label">é‚®ç®±</span>
                                <span class="detail-value copyable" onclick="copyToClipboard('${acc.email}')">${acc.email || '-'}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">çŠ¶æ€</span>
                                <span class="detail-value">
                                    <span class="status-badge status-${getStatusClass(acc.status)}">${getStatusText(acc.status)}</span>
                                </span>
                            </div>
                            ${acc.error_message ? `
                            <div class="detail-item">
                                <span class="detail-label">é”™è¯¯ä¿¡æ¯</span>
                                <span class="detail-value" style="color: var(--error-color);">${acc.error_message}</span>
                            </div>
                            ` : ''}
                            <div class="detail-item">
                                <span class="detail-label">åˆ›å»ºæ—¶é—´</span>
                                <span class="detail-value">${formatDate(acc.created_at)}</span>
                            </div>
                            ${acc.updated_at ? `
                            <div class="detail-item">
                                <span class="detail-label">æ›´æ–°æ—¶é—´</span>
                                <span class="detail-value">${formatDate(acc.updated_at)}</span>
                            </div>
                            ` : ''}
                        </div>
                        
                        <div class="detail-section">
                            <h4>ğŸ” Cookie & ç»„ç»‡ä¿¡æ¯</h4>
                            <div class="detail-item">
                                <span class="detail-label">Team ID</span>
                                <span class="detail-value ${acc.config_id ? 'copyable' : 'empty'}" 
                                      ${acc.config_id ? `onclick="copyToClipboard('${acc.config_id}')"` : ''}>
                                    ${acc.config_id || '(æœªè·å–)'}
                                </span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">csesidx</span>
                                <span class="detail-value ${acc.csesidx ? 'copyable' : 'empty'}"
                                      ${acc.csesidx ? `onclick="copyToClipboard('${acc.csesidx}')"` : ''}>
                                    ${acc.csesidx || '(æœªè·å–)'}
                                </span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">__Host-C_OSES</span>
                                <span class="detail-value ${acc.c_oses ? 'copyable' : 'empty'}"
                                      ${acc.c_oses ? `onclick="copyToClipboard('${acc.c_oses}')"` : ''}>
                                    ${acc.c_oses || '(æœªè·å–)'}
                                </span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">__Secure-C_SES</span>
                                <span class="detail-value ${acc.c_ses ? 'copyable' : 'empty'}"
                                      ${acc.c_ses ? `onclick="copyToClipboard('${acc.c_ses}')"` : ''}>
                                    ${acc.c_ses || '(æœªè·å–)'}
                                </span>
                            </div>
                        </div>
                    `;
                    openModal('detailModal');
                }
            } catch (error) {
                showToast('è·å–è¯¦æƒ…å¤±è´¥', 'error');
            }
        }

        // å¤åˆ¶åˆ°å‰ªè´´æ¿
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            }).catch(() => {
                showToast('å¤åˆ¶å¤±è´¥', 'error');
            });
        }

        // åˆ·æ–°è´¦å·
        async function refreshAccount(email) {
            try {
                const response = await apiRequest(`/api/accounts/${encodeURIComponent(email)}/refresh`, {
                    method: 'POST'
                });

                const data = await response.json();

                if (data.success) {
                    showToast('åˆ·æ–°å·²å¼€å§‹', 'success');
                    loadAccounts();
                } else {
                    showToast(data.error || 'åˆ·æ–°å¤±è´¥', 'error');
                }
            } catch (error) {
                showToast('ç½‘ç»œé”™è¯¯', 'error');
            }
        }

        // é‡è¯•å¤±è´¥çš„è´¦å·
        async function retryAccount(email) {
            try {
                const response = await apiRequest(`/api/accounts/${encodeURIComponent(email)}/retry`, {
                    method: 'POST'
                });

                const data = await response.json();

                if (data.success) {
                    showToast('é‡è¯•å·²å¼€å§‹', 'success');
                    loadAccounts();
                } else {
                    showToast(data.error || 'é‡è¯•å¤±è´¥', 'error');
                }
            } catch (error) {
                showToast('ç½‘ç»œé”™è¯¯', 'error');
            }
        }

        // åˆ·æ–°æ‰€æœ‰è´¦å·
        async function refreshAllAccounts() {
            if (!confirm('ç¡®å®šè¦åˆ·æ–°æ‰€æœ‰æˆåŠŸçš„è´¦å·å—ï¼Ÿ')) return;

            try {
                const response = await apiRequest('/api/accounts/refresh-all', {
                    method: 'POST'
                });

                const data = await response.json();

                if (data.success) {
                    showToast(data.message, 'success');
                    loadAccounts();
                } else {
                    showToast(data.error || 'æ“ä½œå¤±è´¥', 'error');
                }
            } catch (error) {
                showToast('ç½‘ç»œé”™è¯¯', 'error');
            }
        }

        // åœæ­¢è´¦å·
        async function stopAccount(email) {
            try {
                const response = await apiRequest(`/api/accounts/${encodeURIComponent(email)}/stop`, {
                    method: 'POST'
                });

                const data = await response.json();

                if (data.success) {
                    showToast('å·²åœæ­¢', 'success');
                    loadAccounts();
                } else {
                    showToast(data.error || 'åœæ­¢å¤±è´¥', 'error');
                }
            } catch (error) {
                showToast('ç½‘ç»œé”™è¯¯', 'error');
            }
        }

        // åœæ­¢æ‰€æœ‰
        async function stopAll() {
            if (!confirm('ç¡®å®šè¦åœæ­¢æ‰€æœ‰æ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡å—ï¼Ÿ')) return;

            try {
                const response = await apiRequest('/api/accounts/stop-all', {
                    method: 'POST'
                });

                const data = await response.json();

                if (data.success) {
                    showToast(data.message, 'success');
                    loadAccounts();
                } else {
                    showToast(data.error || 'æ“ä½œå¤±è´¥', 'error');
                }
            } catch (error) {
                showToast('ç½‘ç»œé”™è¯¯', 'error');
            }
        }

        // åˆ é™¤è´¦å·
        async function deleteAccount(email) {
            if (!confirm(`ç¡®å®šè¦åˆ é™¤è´¦å· ${email} å—ï¼Ÿ`)) return;

            try {
                const response = await apiRequest(`/api/accounts/${encodeURIComponent(email)}`, {
                    method: 'DELETE'
                });

                const data = await response.json();

                if (data.success) {
                    showToast('åˆ é™¤æˆåŠŸ', 'success');
                    loadAccounts();
                } else {
                    showToast(data.error || 'åˆ é™¤å¤±è´¥', 'error');
                }
            } catch (error) {
                showToast('ç½‘ç»œé”™è¯¯', 'error');
            }
        }

        // å¯¼å‡ºè´¦å·
        async function exportAccounts() {
            try {
                const response = await apiRequest('/api/accounts/export');
                const data = await response.json();

                if (!data.accounts || data.accounts.length === 0) {
                    showToast('æ²¡æœ‰å¯å¯¼å‡ºçš„è´¦å·', 'warning');
                    return;
                }

                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `gemini_accounts_${new Date().toISOString().slice(0, 10)}.json`;
                a.click();
                URL.revokeObjectURL(url);

                showToast(`æˆåŠŸå¯¼å‡º ${data.accounts.length} ä¸ªè´¦å·`, 'success');
            } catch (error) {
                showToast('å¯¼å‡ºå¤±è´¥', 'error');
            }
        }

        // åŠ è½½è®¾ç½®
        async function loadSettings() {
            try {
                const response = await apiRequest('/api/settings');
                const data = await response.json();

                if (data.success) {
                    const settings = data.settings;
                    document.getElementById('settingUA').value = settings.user_agent || '';
                    document.getElementById('settingMaxWorkers').value = settings.max_workers || 1;
                    document.getElementById('settingHeadless').value = (settings.headless !== false).toString();

                    if (settings.browser_fingerprint) {
                        document.getElementById('settingWindowSize').value = settings.browser_fingerprint.window_size || '';
                        document.getElementById('settingTimezone').value = settings.browser_fingerprint.timezone || '';
                        document.getElementById('settingLocale').value = settings.browser_fingerprint.locale || '';
                    }

                    renderEmailConfigs(settings.email_configs);
                }
            } catch (error) {
                console.error('åŠ è½½è®¾ç½®å¤±è´¥:', error);
            }
        }

        // æ¸²æŸ“é‚®ç®±é…ç½®
        function renderEmailConfigs(configs) {
            const container = document.getElementById('emailConfigList');

            if (!configs || configs.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>æš‚æ— é…ç½®</p></div>';
                return;
            }

            container.innerHTML = configs.map((config, index) => `
                <div class="email-config-item">
                    <span class="domain">${config.worker_domain} / ${config.email_domain}</span>
                    <button class="btn btn-danger btn-small" onclick="deleteEmailConfig(${index})">åˆ é™¤</button>
                </div>
            `).join('');
        }

        // ä¿å­˜è®¾ç½®
        async function saveSettings() {
            try {
                const settings = {
                    user_agent: document.getElementById('settingUA').value,
                    max_workers: parseInt(document.getElementById('settingMaxWorkers').value) || 1,
                    headless: document.getElementById('settingHeadless').value === 'true',
                    browser_fingerprint: {
                        window_size: document.getElementById('settingWindowSize').value,
                        timezone: document.getElementById('settingTimezone').value,
                        locale: document.getElementById('settingLocale').value
                    }
                };

                const response = await apiRequest('/api/settings', {
                    method: 'POST',
                    body: JSON.stringify(settings)
                });

                const data = await response.json();

                if (data.success) {
                    showToast('è®¾ç½®å·²ä¿å­˜', 'success');
                } else {
                    showToast(data.error || 'ä¿å­˜å¤±è´¥', 'error');
                }
            } catch (error) {
                showToast('ç½‘ç»œé”™è¯¯', 'error');
            }
        }

        // æ·»åŠ é‚®ç®±é…ç½®
        function showAddEmailConfig() {
            openModal('emailConfigModal');
        }

        async function addEmailConfig() {
            const workerDomain = document.getElementById('newWorkerDomain').value.trim();
            const emailDomain = document.getElementById('newEmailDomain').value.trim();
            const adminPassword = document.getElementById('newAdminPassword').value;

            if (!workerDomain || !emailDomain || !adminPassword) {
                showToast('è¯·å¡«å†™æ‰€æœ‰å­—æ®µ', 'error');
                return;
            }

            try {
                const response = await apiRequest('/api/email-configs', {
                    method: 'POST',
                    body: JSON.stringify({
                        worker_domain: workerDomain,
                        email_domain: emailDomain,
                        admin_password: adminPassword
                    })
                });

                const data = await response.json();

                if (data.success) {
                    showToast('é…ç½®å·²æ·»åŠ ', 'success');
                    closeModal('emailConfigModal');
                    document.getElementById('newWorkerDomain').value = '';
                    document.getElementById('newEmailDomain').value = '';
                    document.getElementById('newAdminPassword').value = '';
                    loadSettings();
                } else {
                    showToast(data.error || 'æ·»åŠ å¤±è´¥', 'error');
                }
            } catch (error) {
                showToast('ç½‘ç»œé”™è¯¯', 'error');
            }
        }

        // åˆ é™¤é‚®ç®±é…ç½®
        async function deleteEmailConfig(index) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤æ­¤é…ç½®å—ï¼Ÿ')) return;

            try {
                const response = await apiRequest(`/api/email-configs/${index}`, {
                    method: 'DELETE'
                });

                const data = await response.json();

                if (data.success) {
                    showToast('é…ç½®å·²åˆ é™¤', 'success');
                    loadSettings();
                } else {
                    showToast(data.error || 'åˆ é™¤å¤±è´¥', 'error');
                }
            } catch (error) {
                showToast('ç½‘ç»œé”™è¯¯', 'error');
            }
        }

        // è‡ªåŠ¨åˆ·æ–°
        function startAutoRefresh() {
            refreshInterval = setInterval(loadAccounts, 5000);
        }

        function stopAutoRefresh() {
            if (refreshInterval) {
                clearInterval(refreshInterval);
                refreshInterval = null;
            }
        }

        // æ›´æ–°ä¸»é¢˜è‰²
        function updateThemeColor(color) {
            document.documentElement.style.setProperty('--primary-color', color);

            // è®¡ç®—æµ…è‰²å’Œæ·±è‰²å˜ä½“
            const r = parseInt(color.slice(1, 3), 16);
            const g = parseInt(color.slice(3, 5), 16);
            const b = parseInt(color.slice(5, 7), 16);

            document.documentElement.style.setProperty('--primary-light', `rgba(${r}, ${g}, ${b}, 0.1)`);
            document.documentElement.style.setProperty('--primary-dark', `rgb(${Math.max(0, r - 20)}, ${Math.max(0, g - 20)}, ${Math.max(0, b - 20)})`);

            document.getElementById('colorPickerBtn').style.background = color;

            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            localStorage.setItem('themeColor', color);
        }

        // åŠ è½½ä¿å­˜çš„ä¸»é¢˜è‰²
        const savedColor = localStorage.getItem('themeColor');
        if (savedColor) {
            updateThemeColor(savedColor);
            document.getElementById('colorPicker').value = savedColor;
        }

        // æ¨¡æ€æ¡†æ“ä½œ
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Toast é€šçŸ¥
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;

            const icons = {
                success: 'âœ…',
                error: 'âŒ',
                warning: 'âš ï¸'
            };

            toast.innerHTML = `
                <span>${icons[type] || 'ğŸ“¢'}</span>
                <span>${message}</span>
            `;
            container.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'toastIn 0.3s ease reverse';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // å·¥å…·å‡½æ•°
        function formatDate(dateStr) {
            if (!dateStr) return '-';
            try {
                const date = new Date(dateStr);
                if (isNaN(date.getTime())) return '-';
                return date.toLocaleString('zh-CN');
            } catch {
                return '-';
            }
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
    </script>
</body>

</html>
